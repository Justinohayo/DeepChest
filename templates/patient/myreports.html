<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Doctor Reports - DeepChest</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="stylesheet" href="/static/patient.css" />
    <link rel="stylesheet" href="/static/logostyle.css" />
  </head>
  <body>
    <!-- Navigation bar -->
    <nav>
      <div class="logo">
        <a href="/patient_home">
          <img
            src="{{ url_for('static', filename='logo_DeepChest.png') }}"
            class="logo-img"
          />
        </a>
        <div class="logo-text">DeepChest</div>
      </div>
      <div class="nav-links">
        <a href="/patient_home">Home</a>
        <a href="/patient/appointments">Appointments</a>
        <a href="#">Reports</a>
        <a href="/patient/messages">Message</a>
        <a href="/patient/notifications">Notifications</a>
        <div class="dropdown">
          <button class="dropbtn">Account &#9662;</button>
          <div class="dropdown-content">
            <a href="/patient/account">Manage Account</a>
            <a href="/logout">Logout</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main content -->
    <div class="patient-content">
      <h1>Your Patient Reports</h1>
      <p>View and upload diagnostic reports here.</p>

      <!-- Search Bar -->
      <div class="report-search-bar-container">
        <form method="GET" action="/patient/search_reports">
          <input
            type="text"
            name="query"
            class="report-search-bar"
            placeholder="Search for specific reports..."
            autocomplete="off"
          />
          <button type="submit" class="report-search-btn">Search</button>
        </form>
      </div>

      <!-- Reports Table -->
      <div class="patient-reports-table">
        <table class="search-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Doctor Name</th>
              <th>File</th>
            </tr>
          </thead>
          <tbody>
            {% if reports %}
              {% for r in reports %}
              <tr>
                <td>
                  {{ r.reportDate.strftime('%B %#d %Y') if r.reportDate else '' }}
                </td>
                <td>
                  {% if r.doctorFirstName and r.doctorLastName %}
                    {{ r.doctorName }} {{ r.doctorLastName }}
                  {% else %}
                    Patient ID: {{ r.patientID }}
                  {% endif %}
                </td>
                <td>
                  {% if r.files %}
                    <a
                      href="/static/uploads/{{ r.files }}"
                      class="file-link"
                      target="_blank"
                      >{{ r.files }}</a
                    >
                  {% else %}
                    <em>No file uploaded</em>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="3" style="text-align: center;">No reports found.</td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
